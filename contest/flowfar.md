# ไหลไปได้ไกลไหม

วารีนครมีต้นกำเนิดของแหล่งน้ำและมีลำธารมากมายจนยากที่จะดูออกได้ว่าจุดสำคัญแต่ละจุด มีความสำคัญมากน้อยเพียงใด นักธรณีวิทยาจึงได้ทำแผนที่ทิศทางการไหลของน้ำไว้ โดยมีการระบุเป็นจุดสำคัญไว้เป็นหมายเลข และบันทึกว่าลำธารที่เชื่อมต่อระหว่างจุดสำคัญนั้นมีกระแสน้ำไหลในทิศทางใด

อย่างไรก็ตามทั้งจุดสำคัญและลำธารในวารีนครนั้นต่างก็มีจำนวนมาก ทำให้นักธรณีวิทยาไม่สามารถระบุความสำคัญของแหล่งน้ำได้ดีนัก และเพื่อทำให้งานของเขาง่ายขึ้น เขาจึงตั้งอยากทราบว่า สำหรับแต่ละจุดสำคัญ จะมีลำธารไหลเชื่อมจากจุดนั้นไปจุดสำคัญต่างๆได้ทั้งหมดกี่จุด เขาจึงขอร้องให้นักปราชญ์แห่งค่ายคอมเช่นคุณ เขียนโปรแกรมที่หาว่าแต่ละจุดสำคัญจะมีน้ำไหลจากมันไปเชื่อมต่อถึงจุดสำคัญอื่นๆได้กี่จุด

จุดที่ควรใส่ใจคือ

(1) ลำธารแต่ละอันจะมีทิศไหลของน้ำที่แน่นอนไม่เปลี่ยนแปลง

(2) เนื่องจากลำธารจะไหลจากที่สูงลงสู่ที่ต่ำ แสดงว่าจะไม่มีทางไหลเชื่อมต่อถึงจุดสำคัญอื่นๆจนกลับมาที่เดิม

(3) คำว่าน้ำไหลผ่านไปเชื่อมต่อถึงจุดสำคัญอื่นๆ อาจจะไม่ได้หมายถึงลำธารที่เชื่อมต่อกันโดยตรง เช่น ถ้ามีลำธารไหลจากจุดสำคัญ 1 ไป 2 และมีลำธารไหลจาก 2 ไป 3 เราจะกล่าวว่ามีน้ำไหลผ่านจากจุดสำคัญ 1 ไปเชื่อมต่อถึง 3

(4) จุดสำคัญส่วนใหญ่จะมีลำธารเข้าสู่จุดสำคัญนั้นเพียงลำธารเดียว จะมีเพียงไม่กี่จุดสำคัญที่มีลำธารเข้าสู่จุดสำคัญนั้นมากกว่า 1 ลำธาร (มีไม่เกิน $T$ จุดสำคัญ)

จงเขียนโปรแกรมที่หาว่าสำหรับแต่ละจุดสำคัญ จะมีน้ำไหลผ่านไปเชื่อมต่อกับจุดสำคัญอื่นๆ รวมตัวมันเองด้วย เป็นจำนวนกี่จุด (เรานับจำนวนจุดสำคัญที่ไหลไปถึงเป็นสำคัญ จำนวนลำธารไม่ใช่ประเด็นตัดสินในที่นี้)

หมายเหตุ ดัดแปลง (และปรับให้ยากขึ้น) จากโจทย์ข้อสอบ สอวน.ค่าย 2 ศูนย์มหาวิทยาลัยศิลปากร

## ข้อมูลนำเข้า

บรรทัดแรก เป็นจำนวนเต็ม $N$, $E$ และ $T$ ตามลำดับ ซึ่งแทนจำนวนจุดสำคัญและจำนวนลำธาร โดยที่ $1 \leq N \leq 300,000$, $1 \leq E \leq 800,000$ และ $0 \leq T \leq 50$

อีก $E$ บรรทัดถัดมา เป็นค่า $S$ และ $D$ ซึ่ง $S$ แทนหมายเลขจุดสำคัญที่เป็นต้นลำธารและ $D$ แทนหมายเลขจุดสำคัญที่เป็นปลายลำธาร ทั้งนี้หมายเลขจุดสำคัญเริ่มนับจาก $0$ ไปจนถึง $N-1$ และค่า $S$ และ $D$ เป็นหมายเลขจุดสำคัญที่ถูกต้องแน่นอน

หมายเหตุ
(1) รับประกันว่า $S$ และ $D$ จะไม่เป็นจุดเดียวกัน
(2) ลำธารสองอันจะไม่มีทางมีจุดเริ่มต้นและสิ้นสุดเหมือนกัน

## ข้อมูลส่งออก

มีทั้งหมด $N$ บรรทัด ในบรรทัดที่ $i+1$ ระบุจำนวนจุดสำคัญอื่นๆ ที่สามารถมีน้ำไหลผ่านไปเชื่อมได้ โดยเริ่มจากจุดสำคัญที่ $i$ สำหรับ $i$ ตั้งแต่ $0$ ถึง $N-1$

## การให้คะแนน

ชุดทดสอบที่ 1 (5 คะแนน) $N \leq 500$ และ $E \leq 10,000$

ชุดทดสอบที่ 2 (10 คะแนน) $N \leq 2,000$ และ $E \leq 10,000$

ชุดทดสอบที่ 3 (25 คะแนน) $T = 0$

ชุดทดสอบที่ 4 (30 คะแนน) $T = 1$

ชุดทดสอบที่ 5 (30 คะแนน) ไม่มีเงื่อนไขเพิ่มเติม

## ตัวอย่าง

ข้อมูลนำเข้า 1:

```
7 8 2
0 1
0 2
1 3
4 1
5 2
5 6
6 0
6 4
```

ข้อมูลส่งออก 1:

```
4
2
1
1
3
7
6
```

ข้อมูลนำเข้า 2:

```
9 6 0
0 7
0 2
3 4
3 5
3 6
7 8
```

ข้อมูลส่งออก 2:

```
4
1
1
4
1
1
1
2
1
```

ข้อมูลนำเข้า 3:

```
8 13 3
0 7
5 7
7 2
7 1
6 1
2 1
3 5
5 1
0 1
4 2
3 0
6 7
6 4
```

ข้อมูลส่งออก 3:

```
4
1
2
6
3
4
5
3
```

## ข้อจำกัด

Time Limit: 5 seconds

Memory Limit: 256 megabytes
